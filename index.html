<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ุฎุฏูุฉ ูุตูุชู โ ุตูุฏููุงุช ุดูุณ</title>
<style>
  body{font-family:Tahoma,Arial,sans-serif;margin:0;background:#f7fafc;}
  .wrap{max-width:720px;margin:16px auto;background:#fff;padding:20px;border-radius:16px;box-shadow:0 5px 20px rgba(0,0,0,0.08);}
  h1{margin:0 0 6px;font-size:22px;}
  .seg{display:flex;gap:8px;margin:10px 0;}
  .seg button{flex:1;padding:12px;border-radius:10px;border:1px solid #ccc;background:#f0f9ff;font-weight:700;cursor:pointer;}
  .seg button.active{background:#0284c7;color:#fff;border-color:#0284c7;}
  label{display:block;margin-top:12px;font-weight:600;}
  input,textarea{width:100%;padding:10px;border:1px solid #d1d5db;border-radius:8px;}
  textarea{min-height:70px;}
  .actions{margin-top:18px;}
  .btn{width:100%;padding:14px;border:none;border-radius:10px;font-size:16px;font-weight:bold;cursor:pointer;}
  .btn-primary{background:#0ea5e9;color:#fff;}
  .error{color:#b91c1c;font-size:14px;margin-top:6px;}
  #doneView{text-align:center;}
  .footer{text-align:center;margin-top:20px;color:#666;font-size:13px;}
</style>
</head>

<body>
<div class="wrap">
<h1>ุฎุฏูุฉ ูุตูุชู โ ุตูุฏููุงุช ุดูุณ</h1>
<p>ุงุฎุชูุฑ ุทุฑููุฉ ุงุณุชูุงู ูุตูุชู</p>

<div class="seg" id="modeSeg">
  <button data-mode="pickup" class="active">๐ถโโ๏ธ ุงุณุชูุงู ูู ุงููุฑุน</button>
  <button data-mode="delivery">๐ ุชูุตูู ููููุฒู</button>
</div>

<div id="formView">

<label>ุฑูู ุงููููุฉ (ูุทููุจ)</label>
<input id="id_number" type="text" placeholder="1012345678">

<label>ุฑูู ุงููุตูุฉ (ูุฏ ูุจุฏุฃ ุจุญุฑู)</label>
<input id="rx_number" type="text" placeholder="A123456789">

<div id="deliveryBlock" style="display:none;">
  <label>ุฑูู ุงูุฌูุงู ููุชูุตูู</label>
  <input id="mobile" type="tel" placeholder="05xxxxxxxx">

  <label>๐ ุชุญุฏูุฏ ูููุนู (ุงุฎุชูุงุฑู)</label>
  <button id="locBtn" style="margin-top:6px;padding:10px;background:#10b981;color:#fff;border:none;border-radius:8px;cursor:pointer;">
    ุชุญุฏูุฏ ูููุนู ุงูุขู
  </button>
  <div id="locStatus" style="font-size:13px;margin-top:6px;"></div>

  <label>ูุตู ุงูุนููุงู (ุงุฎุชูุงุฑู)</label>
  <textarea id="addr" placeholder="ุงุณู ุงูุญู + ุฃูุฑุจ ูุนูู"></textarea>

  <label>ุฑุงุจุท ูููุน ุฎุฑุงุฆุท ุฌูุฌู (ุงุฎุชูุงุฑู)</label>
  <input id="maps_link" type="text" placeholder="https://maps.app.goo.gl/...">
</div>

<div style="margin-top:10px;">
<input id="consent" type="checkbox"> ุฃูุงูู ุนูู ูุดุงุฑูุฉ ุจูุงูุงุชู ูุบุฑุถ ุชุฌููุฒ ุงูุทูุจ
</div>

<div class="actions">
<button class="btn btn-primary" id="sendBtn">ุฅุฑุณุงู ุงูุทูุจ ุงูุขู</button>
</div>

<div id="errorMsg" class="error"></div>

</div>

<div id="doneView" style="display:none;">
<h2>โ ุชู ุชุฌููุฒ ุงูุทูุจ</h2>
<p>ุชู ูุชุญ ุงููุงุชุณุงุจ ูุฅุฑุณุงู ุงูุฑุณุงูุฉ</p>
<p style="font-size:13px;color:#555;">ูู ุญุงู ุนุฏู ุงููุชุญ ุชููุงุฆููุง ููููู ุงูุชูุงุตู ูุจุงุดุฑุฉ ุนุจุฑ ุงูุฒุฑ ุจุงูุฃุณูู</p>
<a id="waLink" class="btn btn-primary" style="display:block;margin-bottom:8px;" target="_blank">๐ ุชูุงุตู ุนุจุฑ ูุงุชุณุงุจ</a>
<button id="newReq" class="btn" style="background:#ddd;">ุทูุจ ุฌุฏูุฏ</button>
</div>

<div class="footer">
ุตูุฏููุฉ ุดูุณ โ ุญู ุงูุฏุงุฑ ุงูุจูุถุงุก โ ุดุงุฑุน ุงุจู ุญุฌุฑ<br>
ูุงุชุณุงุจ: 0592627644
</div>
</div>

<script>
(function(){
  const WHATSAPP = "966592627644";
  const modeSeg = document.getElementById("modeSeg");
  const deliveryBlock=document.getElementById("deliveryBlock");
  const idEl=document.getElementById("id_number");
  const rxEl=document.getElementById("rx_number");
  const mobileEl=document.getElementById("mobile");
  const addrEl=document.getElementById("addr");
  const mapsEl=document.getElementById("maps_link");
  const consentEl=document.getElementById("consent");
  const errorMsg=document.getElementById("errorMsg");
  const locStatus=document.getElementById("locStatus");
  const waLink=document.getElementById("waLink");
  const formView=document.getElementById("formView");
  const doneView=document.getElementById("doneView");
  let mode="pickup";
  let gpsLink="";

  modeSeg.addEventListener("click",(e)=>{
    const b=e.target.closest("button[data-mode]");
    if(!b) return;
    mode=b.dataset.mode;
    [...modeSeg.children].forEach(x=>x.classList.remove("active"));
    b.classList.add("active");
    deliveryBlock.style.display=(mode==="delivery")?"block":"none";
  });

  document.getElementById("locBtn").onclick=()=>{
    if(!navigator.geolocation){
      locStatus.innerHTML="โ ุงููุชุตูุญ ูุง ูุฏุนู ุชุญุฏูุฏ ุงููููุน";
      return;
    }
    locStatus.innerHTML="โณ ุฌุงุฑู ุชุญุฏูุฏ ุงููููุน...";
    navigator.geolocation.getCurrentPosition(pos=>{
      gpsLink=`https://maps.google.com/?q=${pos.coords.latitude},${pos.coords.longitude}`;
      locStatus.innerHTML="โ ุชู ุงูุชูุงุท ูููุนู";
    },err=>{
      locStatus.innerHTML="โ ุชุนุฐุฑ ุชุญุฏูุฏ ุงููููุน";
    });
  };

  function buildMessage(){
    let m="";
    m+=(mode==="pickup"? "๐ ุงุณุชูุงู ูู ุงููุฑุน":"๐ ุชูุตูู ููููุฒู")+"\n";
    m+="ุฑูู ุงููููุฉ: "+idEl.value+"\n";
    m+="ุฑูู ุงููุตูุฉ: "+rxEl.value+"\n";
    if(mode==="delivery"){
      if(mobileEl.value) m+="ุงูุฌูุงู: "+mobileEl.value+"\n";
      if(addrEl.value) m+="ุงูุนููุงู: "+addrEl.value+"\n";
      if(gpsLink) m+="๐ ุงููููุน: "+gpsLink+"\n";
      else if(mapsEl.value) m+="๐ ุงููููุน: "+mapsEl.value+"\n";
    }
    m+="\n*ุงูุนููู ูุงูู ุนูู ูุดุงุฑูุฉ ุงูุจูุงูุงุช*";
    return m;
  }

  document.getElementById("sendBtn").onclick=()=>{
    errorMsg.innerHTML="";
    if(!idEl.value || !rxEl.value)
      return errorMsg.innerHTML="โ ุฃุฏุฎู ุฑูู ุงููููุฉ ูุงููุตูุฉ";
    if(mode==="delivery" && !mobileEl.value)
      return errorMsg.innerHTML="โ ุฃุฏุฎู ุงูุฌูุงู ููุชูุตูู";
    if(!consentEl.checked)
      return errorMsg.innerHTML="โ ุจุฑุฌุงุก ุงูููุงููุฉ ูุฅุฑุณุงู ุงูุทูุจ";

    const msg=buildMessage();
    const waURL="https://wa.me/"+WHATSAPP+"?text="+encodeURIComponent(msg);

    // โ ูุชุญ ุงููุงุชุณุงุจ ููุฑูุง
    window.location.href=waURL;

    // ุฅุธูุงุฑ ุดุงุดุฉ ุงูุชุฃููุฏ ููู ูุนูุฏ ููุตูุญุฉ
    formView.style.display="none";
    doneView.style.display="block";
    waLink.href=waURL;
  };

  document.getElementById("newReq").onclick=()=>location.reload();
})();
</script>

</body>
</html>
